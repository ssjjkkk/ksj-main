package pdfbox_sample.test;

import org.apache.pdfbox.pdmodel.PDPage;

import org.apache.pdfbox.pdmodel.PDPageContentStream;

import org.apache.pdfbox.pdmodel.PDDocument;

import org.apache.pdfbox.pdmodel.font.PDFont;

import org.apache.pdfbox.pdmodel.font.PDTrueTypeFont;

import org.apache.pdfbox.pdmodel.font.PDType0Font;

import org.apache.pdfbox.pdmodel.font.PDType1Font;

import org.apache.pdfbox.pdmodel.graphics.image.JPEGFactory;

import org.apache.pdfbox.pdmodel.graphics.image.PDImageXObject;

import org.jfree.chart.ChartFactory;

import org.jfree.chart.JFreeChart;

import org.jfree.chart.axis.NumberAxis;

import org.jfree.chart.axis.NumberTickUnit;

import org.jfree.chart.block.BlockBorder;

import org.jfree.chart.plot.PiePlot3D;

import org.jfree.chart.plot.PlotOrientation;

import org.jfree.chart.plot.XYPlot;

import org.jfree.chart.renderer.xy.XYLineAndShapeRenderer;

import org.jfree.data.general.DefaultPieDataset;

import org.jfree.data.xy.XYDataset;

import org.jfree.data.xy.XYSeries;

import org.jfree.data.xy.XYSeriesCollection;



import java.awt.*;

import java.awt.image.BufferedImage;

import java.io.File;

import java.io.FileInputStream;

import java.io.InputStream;

import java.util.Random;



public class ChartPDF {

	

    public static void main(String[] args) {

        try {

            DefaultPieDataset dataset = new DefaultPieDataset();

            dataset.setValue("One", new Double(43.2));

            dataset.setValue("Two", new Double(10.0));

            dataset.setValue("Three", new Double(27.5));

            dataset.setValue("Four", new Double(17.5));

            dataset.setValue("Five", new Double(11.0));

            dataset.setValue("Six", new Double(19.4));



            JFreeChart chart = ChartFactory.createPieChart3D(

                    "Pie Chart Demo 1",  // chart title

                    dataset,             // data

                    true,               // include legend

                    true,

                    false

            );



            PiePlot3D plot = (PiePlot3D) chart.getPlot();

            plot.setLabelFont(new Font("SansSerif", Font.PLAIN, 12));

            plot.setNoDataMessage("No data available");

            plot.setCircular(false);

            plot.setLabelGap(0.02);



            BufferedImage chartImage = chart.createBufferedImage(300, 200);

            

            //============================================================

            XYSeries Goals = new XYSeries("Goals Scored");

            

            Goals.add	(	0.2	,		212	);

            Goals.add	(	0.4	,	-	213	);

            Goals.add	(	0.6	,		214	);

            Goals.add	(	0.8	,	-	215	);

            Goals.add	(	1	,		216	);

            Goals.add	(	1.2	,	-	217	);

            Goals.add	(	1.4	,		218	);

            Goals.add	(	1.6	,	-	219	);

            Goals.add	(	1.8	,		220	);

            Goals.add	(	2	,	-	221	);

            Goals.add	(	2.2	,		222	);

            Goals.add	(	2.4	,	-	223	);

            Goals.add	(	2.6	,		224	);

            Goals.add	(	2.8	,	-	225	);

            Goals.add	(	3	,		226	);

            Goals.add	(	3.2	,	-	227	);

            Goals.add	(	3.4	,		228	);

            Goals.add	(	3.6	,	-	229	);

            Goals.add	(	3.8	,		230	);

            Goals.add	(	4	,	-	231	);

            Goals.add	(	4.2	,		232	);

            Goals.add	(	4.4	,	-	233	);

            Goals.add	(	4.6	,		234	);

            Goals.add	(	4.8	,	-	235	);

            Goals.add	(	5	,		236	);

            Goals.add	(	5.2	,	-	237	);

            Goals.add	(	5.4	,		238	);

            Goals.add	(	5.6	,	-	239	);

            Goals.add	(	5.8	,		240	);

            Goals.add	(	6	,	-	241	);

            Goals.add	(	6.2	,		242	);

            Goals.add	(	6.4	,	-	243	);

            Goals.add	(	6.6	,		244	);

            Goals.add	(	6.8	,	-	245	);

            Goals.add	(	7	,		246	);

            

            System.out.println("Goals"+Goals.getClass());

            

            XYDataset xyDataset = new XYSeriesCollection(Goals);

            JFreeChart chart1 = ChartFactory.createXYLineChart(

                "", "Fixture Number", "",

                xyDataset, PlotOrientation.VERTICAL, true, true, false);

            

            // x축 설정

            XYPlot xyplot = (XYPlot) chart1.getPlot();

            final NumberAxis xAxis = (NumberAxis) xyplot.getDomainAxis();

            //x 축 1초 간격 설정

            xAxis.setTickUnit(new NumberTickUnit(1)); 

            //x 축 보조선 간격 설정

            xAxis.setMinorTickCount(5);

            

            chart1.removeLegend();

            

            XYLineAndShapeRenderer renderer = new XYLineAndShapeRenderer();

            //line 색 설정

            renderer.setSeriesPaint(0, Color.blue);

            //line 두께 설정

            //renderer.setSeriesStroke(0, new BasicStroke(2.0f));

            

            //값 점 찍기 설정

            //xyplot.setRenderer(renderer);

            

            //배경색 설정

            xyplot.setBackgroundPaint(Color.WHITE);



            xyplot.setRangeGridlinesVisible(true);

            // y 값 라인 색설정

            xyplot.setRangeGridlinePaint(Color.BLACK);



            xyplot.setDomainGridlinesVisible(true);

            // x 값 라인 색설정

            xyplot.setDomainGridlinePaint(Color.RED);

            

            //x 축 보조선 설정

            xyplot.setDomainMinorGridlinesVisible(true);

            xyplot.setDomainMinorGridlineStroke(new BasicStroke(0.1f));

            xyplot.setDomainMinorGridlinePaint(Color.black);



            //chart.getLegend().setFrame(BlockBorder.NONE);



            BufferedImage chartImage1 = chart1.createBufferedImage(600, 200);

            

            BufferedImage chartImage2 = chart1.createBufferedImage(600, 120);

            //================================================================



            PDDocument document = new PDDocument();

            PDPage page = new PDPage();



	            document.addPage(page);

	            

//	            pdf파일 내 한글 표기하기

            InputStream fontStream = new FileInputStream("c:/Windows/Fonts/malgun.TTF");

            PDType0Font font = PDType0Font.load(document, fontStream);

//	            PDFont font = PDType1Font.HELVETICA;

	            

            PDPageContentStream content = new PDPageContentStream(document, page);

            content.beginText();

            content.setFont( font, 12 );

            content.newLineAtOffset(10, 750);

            

            //줄 간격

            content.setLeading(14.5f) ;



            String text1 = "====================================================================================";

            String text2 = "VitalPatch Detail-All Report";

            String text3 = "====================================================================================";

            String text4 = " name    : Tester가나다";

            String text5 = "2017-06-02 14:00:00";

            String text6 = "====================================================================================";



            //Adding text in the form of string

            content.showText (text1);

            content.newLine() ;

            content.showText (text2);

            content.newLine() ;

            content.showText (text3);

            content.newLine() ;

            content.showText (text4);

            content.newLine() ;

            content.showText (text5);

            content.newLine() ;

            content.showText (text6);

            //Ending the content stream

            content.endText();

            System.out.println("1");



            PDImageXObject pdfChartImage = JPEGFactory.createFromImage(document, chartImage, 1f);

            //content.drawImage(pdfChartImage, 50, 500);

            

            //================================================================

            PDImageXObject pdfChartImage1 = JPEGFactory.createFromImage(document, chartImage1, 1f);

            //그림 생성 위치

            content.drawImage(pdfChartImage1, 0, 450);

            

            content.drawImage(pdfChartImage1, 0, 250);

            

            content.drawImage(pdfChartImage1, 0, 50);



            content.close();

            

            System.out.println("2");

            

            PDPage page2 = new PDPage();

            

            document.addPage(page2);



            PDPageContentStream content2 = new PDPageContentStream(document, page2);

            content2.beginText();

            content2.setFont( font, 24 );

            content2.newLineAtOffset(10, 750);

         

 //줄 간격

            content2.setLeading(14.5f) ;



            String text7 = "sadassdasdasd";

           

            content2.showText (text7);

            

            content2.endText();

            

            PDImageXObject pdfChartImage2 = JPEGFactory.createFromImage(document, chartImage2, 1f);

            

            content2.drawImage(pdfChartImage2, 0, 520);

            

            content2.drawImage(pdfChartImage2, 0, 390);



            content2.drawImage(pdfChartImage2, 0, 260);



            content2.drawImage(pdfChartImage2, 0, 130);

            

            content2.drawImage(pdfChartImage2, 0, 0);



            content2.close();



            document.save("C:/Temp/est.pdf");

            

            document.close();

            System.out.println("3");

        } catch (Exception e) {

            throw new RuntimeException(e);

        }



    }

}
